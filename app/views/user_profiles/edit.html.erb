<div class='profile_edit'>
<h1>Editing user_profile</h1>
  <% form_for @user_profile, :html => {:multipart => true} do |form| %>
    <%= form.error_messages %>
		
		<% fields_for :user, @user_profile.user do |user_form| %>
			<fieldset>
				<legend>Account information</legend>
				<%= render :partial => "users/user_account_form", :locals => { :form => user_form } %>
			</fieldset>
		<% end %>

		<fieldset>
			<legend>Public Profile</legend>
			<p>This is information you can choose to make public through the OpenPHIN directory.
			It is not required that you fill any part of this profile out, or that you make the information public if you do. </p>

    <p>
      <%= form.label :public, "Make this profile public?" %>
      <%= form.check_box :public %>
    </p>

  <p>
    <%= image_tag form.object.photo.url(:medium) %>
    <%= form.label :photo %><br />
    <%= form.file_field :photo %>
  </p>

  <p>
      <b><%= form.label :bio %></b><br/>
      Tell us a bit about yourself.<br/>
      <%= form.text_area :bio, :cols => 60, :rows =>5, :class => "bio" %>
    </p>

    <p>
      <b><%= form.label :credentials %></b><br/>
      List any degrees, certifications, or other professional credentials you have.<br/>
      <%= form.text_area :credentials, :cols => 60, :rows =>5 %>
    </p>

    <p>
      <b><%= form.label :experience %></b><br/>
      List any experience you have in other areas besides your profession. (E.g. SCUBA, photography, carpentry, etc)<br/>
      <%= form.text_area :experience, :cols => 60, :rows =>5 %>
    </p>

    <p>
      <b><%= form.label :employer %></b><br/>
      <%= form.text_field :employer, :cols => 60, :rows =>5 %>
    </p>
    </fieldset>
    
    
    <fieldset id="devices">
      <legend>Devices</legend>
      
      <%= render form.object.user.devices, :in_form => true %>
      
      <div id="new_device">
        <%- fields_for :device, @device ||= Device::EmailDevice.new do |device_form| -%>
          <%= device_form.error_messages %>
        
          <p>
            <%= device_form.label :type, 'Device Type' %>
            <%= select_tag :device_type, options_for_select([['Selectâ€¦', nil]] + Device::Types.map{|t| [t.display_name, t.name]}, params[:device_type])%>
          </p>
        
          <p>
            <%= device_form.label :email_address, 'E-mail' %>
            <%= device_form.text_field :email_address %>
          </p>
        
          <p>
            <%= form.submit "Save Device" %>
          </p>
        <%- end -%>
      </div>
        
      <a href="#add-device", class="add_device">Add Device</a>
    </fieldset>
    
    
    <p>
      <%= form.submit 'Save' %>
    </p>
  <% end %>
</div>
  <%= link_to 'Show', @user_profile %>